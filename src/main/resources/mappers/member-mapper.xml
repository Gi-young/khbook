<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="member">

	<insert id="insertMember">
		INSERT INTO MEMBER
		VALUES(#{memberId},#{memberPw},#{memberName},#{memberEmail},#{memberPhone},#{memberAddress},#{memberGender},#{memberBirth},0,SYSDATE,1)
	</insert>

	<!-- 멤버에 상속해줄 부모 VO -->
	<resultMap type="membergrade" id="membergradeMap">
		<result column="membergrade_no" property="membergradeNo" />
		<result column="membergrade_name" property="membergradeName" />
		<result column="membergrade_standard" property="membergradeStandard" />
		<result column="membergrade_content" property="membergradeContent" />
		<result column="membergrade_img" property="membergradeImg" />
	</resultMap>

	<resultMap type="member" id="memberMap"
		extends="membergradeMap">
		<result column="member_id" property="memberId" />
		<result column="member_pw" property="memberPw" />
		<result column="member_name" property="memberName" />
		<result column="member_email" property="memberEmail" />
		<result column="member_phone" property="memberPhone" />
		<result column="member_address" property="memberAddress" />
		<result column="member_gender" property="memberGender" />
		<result column="member_birth" property="memberBirth" />
		<result column="member_point" property="memberPoint" />
		<result column="member_regidate" property="memberRegiDate" />
		<result column="member_memberGrade_no" property="memberGradeNo" />
	</resultMap>

	<!-- 쿠폰에 상속해줄 부모 VO -->
	<resultMap type="couponlist" id="couponlistMap">
		<result column="couponlist_no" property="couponlistNo" />
		<result column="couponlist_grade" property="couponlistGrade" />
		<result column="couponlist_percent"
			property="couponlistPercent" />
		<result column="couponlist_amount" property="couponlistAmount" />
		<result column="couponlist_foruse" property="couponlistForuse" />
		<result column="couponlist_invalid"
			property="couponlistInvalid" />
		<result column="couponlist_name" property="couponlistName" />
		<result column="couponlist_condition"
			property="couponlistCondition" />
	</resultMap>

	<!-- 쿠폰리스트를 상속받는 쿠폰 VO -->
	<resultMap type="coupon" id="couponMap"
		extends="couponlistMap">
		<result column="coupon_no" property="couponNo" />
		<result column="coupon_invalid" property="couponInvalid" />
		<result column="coupon_member_id" property="couponMemberId" />
		<result column="coupon_couponlist_no"
			property="couponCouponlistNo" />
		<result column="coupon_canuse" property="couponCanuse" />
		<result column="coupon_img" property="couponImg" />
	</resultMap>

	<select id="selectOneMember" resultMap="memberMap">
		SELECT * FROM MEMBER
		WHERE MEMBER_ID=#{memberId}
	</select>

	<select id="searchId1" resultMap="memberMap">
		SELECT * FROM MEMBER WHERE
		MEMBER_NAME=#{memberName} AND MEMBER_PHONE=#{memberPhone}
	</select>

	<select id="searchId2" resultMap="memberMap">
		SELECT * FROM MEMBER WHERE
		MEMBER_NAME=#{memberName} AND MEMBER_EMAIL=#{memberEmail}
	</select>

	<select id="searchId3" resultMap="memberMap">
		SELECT * FROM MEMBER WHERE
		MEMBER_ID=#{memberId} AND MEMBER_NAME=#{memberName} AND
		MEMBER_PHONE=#{memberPhone}
	</select>

	<select id="searchId4" resultMap="memberMap">
		SELECT * FROM MEMBER WHERE
		MEMBER_ID=#{memberId} AND MEMBER_NAME=#{memberName} AND
		MEMBER_EMAIL=#{memberEmail}
	</select>

	<update id="updateMemberPw">
		UPDATE MEMBER SET MEMBER_PW=#{memberPw} WHERE
		MEMBER_ID=#{memberId}
	</update>

	<!-- 쿠폰 조인해서 가져오기 -->
	<select id="getCoupon" resultMap="couponMap">
		SELECT * FROM COUPON LEFT JOIN
		COUPONLIST ON COUPON_COUPONLIST_NO =
		COUPONLIST_NO WHERE
		COUPON_MEMBER_ID=#{memberId}
	</select>
	
	<!-- 회원의 회원등급 가져오기 -->
	<select id = "getMembergrade" resultMap="membergradeMap">
	SELECT * FROM MEMBERGRADE WHERE MEMBERGRADE_NO = #{memberGradeNo}
	</select>
	
	<!-- 전체 회원 등급 가져오기 -->
	<select id = "memberGrade" resultMap="membergradeMap">
	SELECT * FROM MEMBERGRADE
	</select>
</mapper>
